# CHANGELOG Automation

We use [changie](https://changie.dev/) to automate `CHANGELOG` generation.  For installation and format/command specifics, see the documentation.

### Workflow

#### Daily workflow
Each code change gets a changelog file by running `changie new` and following the prompts.  This ensures correct file format and file name.

#### Prerelease Workflow
These commands batch up changes in `/.changes/unreleased` to be included in this prerelease and move those files to a directory named for the release version.  The `--move-dir` will be created if it does not exist and is created in `/.changes`.

```
changie batch <version>  --move-dir '<version>' --prerelease 'rc1'
changie merge
```

#### Final Release Workflow
These commands batch up changes in `/.changes/unreleased` as well as `/.changes/<version>` to be included in this final release and delete all prereleases.  This rolls all prereleases up into a single final release.  All `yaml` files in `/unreleased` and `<version>` will be deleted at this point.

```
changie batch <version>  --include '<version>' --remove-prereleases
changie merge
```

### A Note on Manual Edits
Changie generates markdown files that are parsed together with the `changie merge` command.  Any  changes made directly to `CHANGELOG.md` will be overwritten on the next run of `changie merge`.  If changes need to be made, make them to the `.md` files generated by the `changie batch` command and located in the `/.changes` directory.  Changes made to these files will persist (unless `changie batch` is run again).
